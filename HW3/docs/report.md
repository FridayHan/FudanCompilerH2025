<div style="text-align: center"><h1>
  Compiler Lab Report:
  HW3
  </h1></div>




![logo](/Users/han/Desktop/Compiler/FudanCompilerH2025/pic/logo.svg)

> **Name**: 韩周吾
>
> **ID**: 22307130440
>
> **Date**: 2025.03.29

## Overview

**1. MainMethod 中的类型检查**

​	•	**变量声明重复检查**：检查变量是否在主方法内重复声明。如果变量已经声明，则会输出错误。

​	•	**变量类型递归检查**：对每个变量的类型进行递归分析，调用 node->type->accept(*this) 来分析变量的类型。



**2. ClassDecl 中的类型检查**

​	•	**类变量重复检查**：检查类内部的变量是否有重复声明，如果有，输出错误信息。

​	•	**类成员变量覆盖检查**：检查子类是否覆盖了父类的成员变量，如果覆盖了，则发出警告。

​	•	**父类检查**：如果声明了父类，检查父类是否存在。

​	•	**方法重复检查**：检查类方法是否有重复定义。



**3. MethodDecl 中的类型检查**

​	•	**参数重复检查**：检查方法的形参列表中是否有重复的参数名称。

​	•	**变量声明重复检查**：检查方法内的局部变量是否和参数变量重复，如果有冲突，输出错误。

​	•	**返回类型匹配检查**：在方法的最后，检查返回语句的类型是否和方法声明的返回类型匹配，如果不匹配，输出类型不匹配的错误。



**4. VarDecl 中的类型检查**

​	•	**类作用域变量检查**：如果变量声明在类作用域内，检查该变量是否在类的符号表中已经声明。如果已声明，则输出错误信息，避免重复声明。

​	•	**方法作用域变量检查**：如果变量声明在方法作用域内，检查该变量是否在方法的符号表中已经声明。如果已声明，则输出错误信息，避免重复声明。

​	•	**参数与局部变量冲突检查**：检查方法的局部变量是否与方法的形参冲突。如果有冲突，则输出错误信息。



**5. Assign 中的类型检查**

​	•	**左值检查**：检查赋值语句的左边是否为左值（lvalue）。左值是指可以被赋值的变量、数组元素等。如果左值不是合法的左值，会输出错误信息。

​	•	**类型匹配检查**：检查赋值语句的左右操作数类型是否匹配。如果类型不匹配，则输出错误信息，说明类型不兼容。

​	•	**类类型匹配检查**：在赋值语句中，如果涉及类类型的赋值，会检查是否存在继承关系，确保可以将一个类类型赋值给另一个类类型。如果类型不兼容，输出错误信息。



**6. BinaryOp 中的类型检查**

​	•	**操作数类型检查**：对于二元运算符，检查左右操作数的类型是否匹配。例如，对于算术运算符，左右操作数必须为 int 类型，或者在数组运算中，两个操作数必须是数组且维度相同。

​	•	**数组与整型混合检查**：对于算术运算，如果左边或右边是数组，必须保证两者都是数组，否则会输出错误。

​	•	**数组维度检查**：如果进行数组运算，检查操作数的维度是否匹配，如果不匹配，输出错误信息。



**7. UnaryOp 中的类型检查**

​	•	**表达式类型检查**：对于一元操作符，检查操作数的类型是否匹配。在这里默认一元操作符返回 int 类型，并进行相应的类型设置。



**8. If 和 While 中的条件类型检查**

​	•	**条件表达式类型检查**：对于 if 和 while 语句，检查条件表达式的类型是否为 int 类型。如果条件不是 int 类型，输出错误信息。



**9. Return 中的类型检查**

​	•	**返回值类型检查**：检查方法的返回语句是否符合方法声明的返回类型。如果返回类型不匹配，会输出错误信息。

​	•	**类类型兼容性检查**：对于类类型的返回值，检查返回值的类类型是否与方法声明的返回类类型兼容。如果不兼容，则输出错误信息。



**10. ArrayExp 中的类型检查**

​	•	**数组类型检查**：检查数组表达式的左侧是否为数组类型，并检查索引是否为整型。如果不是数组类型或者索引不是 int 类型，则输出错误信息。

​	•	**数组维度检查**：如果数组的维度不一致，输出错误信息，确保数组操作符两边的数组维度匹配。



**11. CallExp 和 CallStm 中的类型检查**

​	•	**方法调用检查**：检查方法调用时，传入的参数个数和类型是否与方法声明中的形式参数一致。如果不一致，输出错误信息。

​	•	**方法返回类型检查**：检查方法调用的返回类型是否匹配。如果返回类型不匹配，输出错误信息。



**12. This 中的类型检查**

​	•	this **使用检查**：检查 this 关键字是否在类的上下文中使用。如果 this 被用在了主类外的地方，或者在方法外部使用，输出错误信息。


---

## Graphs and Figures

![git_log_graph](./img/git_log_graph.png)  

